<!DOCTYPE html> 
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planta Recicladora (Aluminio) - Proyecto Web</title>
    <!-- Incluye Tailwind CSS para un estilizado moderno -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    
    <!-- LIBRERÍAS THREE.JS AÑADIDAS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    
    <style>
        /* Paleta de colores basada en el metal y la sostenibilidad */
        :root {
            --color-lightest: #F1F3F4;
            --color-header-bg: #1F2628;
            --color-text-main: #333E42;
            --color-interactive-bg: #EAF0F7;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-lightest);
            color: var(--color-text-main);
            transition: background-color 0.3s;
        }
        .header-card {
            background-color: var(--color-header-bg);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        .metallic-card {
            background: white; 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border: 1px solid #e0e0e0;
        }
        .interactive-section {
            background-color: var(--color-interactive-bg);
        }
        .boceto-card {
            border: 1px solid #d0d0d0;
            background-color: #FDFDFD;
            padding: 1rem;
            border-radius: 8px;
            transition: transform 0.2s;
        }
        .boceto-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        /* Clase para el botón activo, para que se vea "presionado" */
        .control-btn.active {
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.5); /* Anillo azul */
            transform: scale(0.98);
        }
        /* Contenedor del Canvas para el mensaje de carga/error */
        #canvas-container {
            position: relative;
        }
        #loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            transition: opacity 0.5s;
            border-radius: 0.5rem;
        }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-top: 4px solid #3b82f6; /* Blue 500 */
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-10">

    <div class="max-w-5xl mx-auto space-y-12">
        
        <!-- HEADER / ENCABEZADO -->
        <header class="text-center p-8 header-card text-white rounded-xl">
            <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight mb-2">
                PLANTA RECICLADORA (ALUMINIO)
            </h1>
            <p class="text-xl font-light text-gray-400">
                El Aluminio que transforma el mundo
            </p>
        </header>

        <!-- INTRODUCCIÓN Y ENLACES DE NAVEGACIÓN RÁPIDA -->
        <section class="p-8 metallic-card rounded-xl">
            <h2 class="text-2xl font-bold mb-4 text-center text-blue-600">Descripción del proyecto</h2>
            <p class="text-gray-700 mb-6 text-center max-w-3xl mx-auto">
                En esta pagina web se plasmó el contenido sobre el funcionamiento de la planta recicladora de aluminio.
            </p>
            
            <!-- Mini-navegación o Resumen Rápido -->
            <div class="flex flex-wrap justify-center gap-4 text-center">
                <a href="#proceso" class="p-3 bg-green-100 text-green-700 rounded-full text-sm font-medium hover:bg-green-200 transition">
                    Proceso
                </a>
                <a href="#interactivo" class="p-3 bg-blue-100 text-blue-700 rounded-full text-sm font-medium hover:bg-blue-200 transition">
                    Menu
                </a>
                <a href="#visualizacion-3d" class="p-3 bg-red-100 text-red-700 rounded-full text-sm font-medium hover:bg-red-200 transition">
                    Video de la planta
                </a>
                <a href="#herramientas" class="p-3 bg-yellow-100 text-yellow-700 rounded-full text-sm font-medium hover:bg-yellow-200 transition">
                    Herramientas
                </a>
            </div>
        </section>

        <!-- SECCIÓN: VISUALIZACIÓN 3D DE LA PLANTA -->
<section id="visualizacion-3d" class="p-4 metallic-card rounded-xl border-t-4 border-green-500">
    <h2 class="text-3xl font-bold text-center text-green-600 mb-6">
        Módulo 3D: Planta Recicladora
    </h2>

    <!-- CUADRO ÚNICO -->
    <div class="border-2 border-green-500 rounded-xl p-4 w-full max-w-5xl mx-auto">

        <video 
            src="planta_1.mp4"
            controls
            autoplay
            loop
            muted
            class="w-full h-[50vh] min-h-[500px] object-cover rounded-lg">
        </video>

        <p class="text-center text-sm text-gray-500 mt-2">
            Selecciona el botón de play y se reproducirá automáticamente el video.
        </p>

    </div>
</section>


<!-- NUEVO CUADRO: IMAGEN DE UBICACIÓN / PLANO -->
<section class="p-4 metallic-card rounded-xl border-t-4 border-emerald-500 mt-8">
    <h2 class="text-2xl font-bold text-center text-emerald-600 mb-4">
        Ubicación de la Planta Recicladora
    </h2>

    <div class="w-full flex justify-center">
        <img 
            src="ubicasion.png"
            alt="Ubicación de la planta recicladora"
            class="w-full max-w-4xl rounded-lg shadow-lg border border-gray-300 object-contain"
        >
    </div>

    <p class="text-center text-sm text-gray-500 mt-3">
        Imagen ilustrativa de la ubicación propuesta para la planta recicladora.
    </p>
</section>

        <!-- CONTENIDO PRINCIPAL E INTERACTIVO (CORREGIDO SIN ICONOS) -->
        <section id="interactivo" class="p-8 metallic-card rounded-xl border-t-4 border-blue-500 interactive-section">
            <h2 class="text-3xl font-bold text-center text-aluminum mb-6">El Contenido Interactivo: Propiedades Clave</h2>
            
            <div class="flex flex-col lg:flex-row gap-8">
                
                <!-- Botones de Interacción (COLUMNA VERTICAL) -->
                <div class="lg:w-1/3 flex flex-col gap-4"> 
                    <button data-key="funciona" class="control-btn p-4 rounded-lg font-semibold text-white bg-blue-500 hover:bg-blue-600 focus:ring-blue-300 transition shadow-lg">
                        1. ¿Cómo funciona?
                    </button>
                    <button data-key="bocetos" class="control-btn p-4 rounded-lg font-semibold text-white bg-gray-700 hover:bg-gray-800 focus:ring-gray-500 transition shadow-lg">
                        2. Bocetos
                    </button>
                    <button data-key="antecedentes" class="control-btn p-4 rounded-lg font-semibold text-white bg-sky-800 hover:bg-sky-900 focus:ring-sky-600 transition shadow-lg">
                        3. Antecedentes
                    </button>
                </div>
                
                <!-- Panel de Contenido Dinámico -->
                <div class="lg:w-2/3 p-6 metallic-card rounded-xl border border-gray-300">
                    <div id="dynamic-content" class="text-aluminum min-h-[300px]">
                        <!-- Contenido cargado por JavaScript -->
                    </div>
                </div>
            </div>
        </section>

        <!-- SECCIÓN 4: MÓDULO INFORMATIVO - ¿CÓMO FUNCIONA LA PLANTA RECICLADORA? -->
        <section id="proceso" class="p-8 bg-gray-900 rounded-xl shadow-2xl text-white">
            <h2 class="text-3xl font-extrabold border-b-2 border-green-400 pb-3 mb-6 text-green-300">Módulo Informativo: El Proceso Reciclador </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <p class="text-gray-300 mb-4 text-lg">
                        La Planta Recicladora de Aluminio es el corazón del proyecto de sostenibilidad. A diferencia de otros materiales, el aluminio puede ser reciclado infinitas veces sin perder sus propiedades.
                    </p>
                    <h3 class="text-xl font-semibold mb-3 text-white">Fases Clave del Ciclo:</h3>
                    <ul class="space-y-3 text-gray-200">
                        <li class="flex items-start">
                            <span class="text-green-400 font-bold mr-2">1.</span>
                            <div>
                                <strong class="text-white">Recolección y Separación:</strong> Separación magnética para aislar el aluminio de otros residuos.
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-400 font-bold mr-2">2.</span>
                            <div>
                                <strong class="text-white">Limpieza y Triturado:</strong> Se retiran pinturas e impurezas, y el metal se compacta para facilitar la fusión.
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-400 font-bold mr-2">3.</span>
                            <div>
                                <strong class="text-white">Fusión Eficiente:</strong> Se funde a unos $750^\circ \text{C}$, usando solo el 5% de la energía necesaria para producir aluminio primario.
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-400 font-bold mr-2">4.</span>
                            <div>
                                <strong class="text-white">Creación de Lingotes:</strong> El metal fundido se moldea en lingotes listos para ser utilizados en nuevas industrias (automoción, envases, construcción).
                            </div>
                        </li>
                    </ul>
                </div>
                <!-- IMAGEN DEL PROCESO DE RECICLAJE (ACTUALIZADA CON EL ARCHIVO SUBIDO) -->
                <div class="flex justify-center items-center">
                    <img src="PLANTARECICLADORA_1.png" 
                        alt="Vista de la maquinaria trituradora en la planta de reciclaje" 
                        class="w-full max-w-md rounded-lg shadow-xl border-4 border-gray-700"
                        onerror="this.onerror=null; this.src='https://placehold.co/400x300/1F2628/F1F3F4?text=ERROR+CARGA+IMAGEN';"
                    >
                </div>
            </div>
        </section>
        
        <!-- SECCIÓN 5: ELECCIÓN DE HERRAMIENTAS (Metodología) -->
        <section id="herramientas" class="p-8 metallic-card rounded-xl">
            <h2 class="text-3xl font-bold mb-6 text-center text-purple-700">Elección de Herramientas para el Desarrollo Web y 3D </h2>
            <p class="text-gray-700 mb-6 text-center">
                Se utilizaron herramientas clave para la estructura web, el diseño responsivo y la creación de los activos 3D de la planta.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                
                <!-- Herramienta 1: Estructura y Contenido -->
                <div class="p-5 border-t-4 border-red-500 rounded-lg shadow-md bg-gray-50">
                    <h3 class="font-bold text-xl mb-2 text-red-600">HTML</h3>
                    <p class="text-sm text-gray-600">
                        Utilizado para la estructura semántica y la organización del contenido. Es la base que soporta el diseño interactivo de la página.
                    </p>
                </div>
                
                <!-- Herramienta 2: BLENDER -->
                <div class="p-5 border-t-4 border-blue-500 rounded-lg shadow-md bg-gray-50">
                    <h3 class="font-bold text-xl mb-2 text-blue-600">Blender </h3>
                    <p class="text-sm text-gray-600">
                        Software de creación de gráficos y animación 3D. Es la herramienta esencial para el Modelado 3D de la planta recicladora (maquinaria, hornos) y la generación de animaciones y renders para el módulo virtual.
                    </p>
                </div>

                <!-- Herramienta 3: Exel (SIN MODIFICAR) -->
                <div class="p-5 border-t-4 border-yellow-500 rounded-lg shadow-md bg-gray-50">
                    <h3 class="font-bold text-xl mb-2 text-yellow-600">Exel</h3>
                    <p class="text-sm text-gray-600">
                        Herramientas complementarias utilizadas para la planificación, organización de datos y flujos de trabajo antes de la implementación web y 3D.
                    </p>
                </div>
            </div>
        </section>

<!-- SECCIÓN: VIDEO RENDERIZADO DE LA PLANTA -->
<section id="render-planta" class="mt-12 p-4 metallic-card rounded-xl border-t-4 border-green-500">

    <h2 class="text-3xl font-bold text-center text-green-600 mb-6">
        Render Final de la Planta Recicladora
    </h2>

    <div class="w-full max-w-5xl mx-auto">
        <video
            src="WhatsApp Video 2026-01-20 at 23.29.13.mp4"
            controls
            autoplay
            loop
            muted
            class="w-full h-[55vh] min-h-[450px] object-cover rounded-xl shadow-lg">
        </video>

        <p class="text-center text-sm text-gray-500 mt-2">
            Visualización renderizada del diseño final de la planta.
        </p>
    </div>

</section>


        <!-- FOOTER -->
        <footer class="mt-12 text-center p-6 border-t border-gray-300 text-gray-600">
            <p class="text-sm">
                Desarrollo Web - Módulo IV: Creación de mundos virtuales para el desarrollo web.
            </p>
        </footer>

    </div>

    <script>
        // --- DATA DEL CONTENIDO INTERACTIVO (SIN ICONOS) ---
        const interactiveData = {
            // Contenido 1: ¿Cómo funciona?
            funciona: {
                title: "Su funcionamiento es:",
                text: "Se encarga de recolectar, clasificar, limpiar y fundir residuos de aluminio (como latas, marcos o cables) para transformarlos en nuevo material útil. Dato importante: Reciclar aluminio ahorra hasta 95 % de la energía necesaria para producirlo desde la bauxita, reduciendo así la contaminación y el uso de recursos naturales.",
                subtitle: 'Propiedad Clave 1: Resistencia'
            },
            
            // Contenido 2: Bocetos (el más importante para tu proyecto)
            bocetos: {
                title: "Bocetos y Diseños:",
                isGallery: true,
                content: `
                    <p class="text-md text-gray-600 mb-4">Estos son los bocetos que se desarrollaron para generar la recicladora en 3D.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <!-- BOCETO 1: Wireframe -->
                        <div class="boceto-card">
                            <img src="imagen_1.jpeg" class="w-full rounded-lg shadow-lg">
                            <p class="text-sm text-center font-semibold text-gray-700">Boceto 1</p>
                        </div>
                        <!-- BOCETO 2: Estructura -->
                        <div class="boceto-card">
                            <img src="imagen_2.jpeg" class="w-full rounded-lg shadow-lg">
                            <p class="text-sm text-center font-semibold text-gray-700">Boceto 2</p>
                        </div>
                    </div>
                    <p class="text-xs text-gray-500 mt-4 text-center">Estas imagenes son producto de una idea plasmada en papel.</p>
                `
            },

            // Contenido 3: Antecedentes
            antecedentes: {
                title: "Antecedentes Históricos y Uso",
                text: "El proyecto de la planta recicladora comenzó en cuarto semestre, donde todas las materias aportaron con actividades. En matemáticas se investigó el funcionamiento de las plantas recicladoras; en inglés se hizo un póster y en ciencias sociales, una investigación sobre sus beneficios. El trabajo principal se desarrolló en el módulo, donde se siguieron las etapas de creación de una animación: preproducción (storyboard y guion de sonidos), modelado, texturizado, animación y renderizado. En el semestre actual, el proyecto continúa con una investigación más completa, se corregirá la animación anterior y se añadirá una página web para mejorar el resultado final.",
                subtitle: 'Propiedad Clave 3: Impacto Histórico'
            }
        };

        // --- LÓGICA DE INTERACCIÓN ---
        const contentPanel = document.getElementById('dynamic-content');
        const buttons = document.querySelectorAll('.control-btn');

        function renderContent(key) {
            const data = interactiveData[key];
            if (!data) return;

            contentPanel.innerHTML = '';
            
            if (data.isGallery) {
                contentPanel.innerHTML = `
                    <h3 class="text-2xl font-extrabold mb-3 text-gray-800 text-center">${data.title}</h3>
                    ${data.content}
                `;
            } else {
                contentPanel.innerHTML = `
                    <div class="flex flex-col items-center text-center">
                        <h3 class="text-2xl font-extrabold mb-2 text-blue-600">${data.title}</h3>
                        <p class="text-lg leading-relaxed text-gray-700 max-w-lg">${data.text}</p>
                    </div>
                `;
            }
        }
        
        buttons.forEach(button => {
            button.addEventListener('click', (e) => {
                buttons.forEach(btn => btn.classList.remove('ring-4', 'ring-offset-2', 'ring-blue-400', 'active'));
                
                e.target.classList.add('ring-4', 'ring-offset-2', 'ring-blue-400', 'active');

                const key = e.target.getAttribute('data-key');
                renderContent(key);
            });
        });

        // --- LÓGICA DE THREE.JS AÑADIDA ---
        let scene, camera, renderer, controls, model;
        let mixer, clock = new THREE.Clock();
        const overlay = document.getElementById('loading-overlay');
        const message = document.getElementById('loading-message');

        /**
         * Actualiza el estado del overlay de carga/error.
         * @param {string} status - 'loading', 'success', 'error'.
         * @param {string} text - Mensaje a mostrar.
         */
        function updateOverlay(status, text) {
            overlay.style.opacity = '1';
            message.textContent = text;
            overlay.style.backgroundColor = status === 'error' ? 'rgba(255, 200, 200, 0.95)' : 'rgba(255, 255, 255, 0.9)';
            const spinner = overlay.querySelector('.spinner');
            if (spinner) {
                spinner.style.display = status === 'loading' ? 'block' : 'none';
            }
            if (status === 'success') {
                overlay.style.opacity = '0';
                setTimeout(() => { overlay.style.display = 'none'; }, 500); // Ocultar después de la transición
            } else {
                overlay.style.display = 'flex';
            }
        }


        /**
         * Inicializa la escena, la cámara y el renderizador de Three.js.
         */
        function initThreeJS() {
            const canvas = document.getElementById('recyclingCanvas');
            const container = canvas.parentElement;

            // 1. Escena
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xf0f0f0); 

            // 2. Cámara (Perspectiva)
            camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            camera.position.set(0, 5, 10); 

            // 3. Renderizador
            renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);

            window.addEventListener('resize', onWindowResize, false);

            // 4. Controles (OrbitControls para interactividad)
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.screenSpacePanning = false;
            controls.minDistance = 5;
            controls.maxDistance = 50;
            controls.target.set(0, 2, 0); 

            // 5. Iluminación
            const ambientLight = new THREE.AmbientLight(0xffffff, 1.5); 
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 2);
            directionalLight.position.set(5, 10, 7);
            scene.add(directionalLight);

            // RUTA CRÍTICA: Usando el contentFetchId para asegurar la carga del GLB
            const modelPath = "uploaded:PLANTARECICLADORA.glb"; 

            updateOverlay('loading', 'Cargando Modelo 3D (Usando ruta interna: ' + modelPath + ')...');

            // 6. Cargar Modelo GLB
            const loader = new THREE.GLTFLoader();
            
            loader.load(modelPath, function (gltf) {
                model = gltf.scene;
                
                // --- INICIA LA ANIMACIÓN ---
                if (gltf.animations && gltf.animations.length) {
                    mixer = new THREE.AnimationMixer(model);
                    const clip = gltf.animations[0]; 
                    const action = mixer.clipAction(clip);
                    action.play(); 
                    console.log(`Animación encontrada y reproduciéndose: ${clip.name || 'Sin Nombre'}`);
                } else {
                    console.warn('Modelo cargado, pero no se encontraron animaciones.');
                }
                
                // Centrar y escalar el modelo (ajuste automático)
                const box = new THREE.Box3().setFromObject(model);
                const center = box.getCenter(new THREE.Vector3());
                const size = box.getSize(new THREE.Vector3());

                // Mover el modelo para que su base esté en y=0
                model.position.x -= center.x;
                model.position.y -= box.min.y; 
                model.position.z -= center.z;
                
                const maxDim = Math.max(size.x, size.y, size.z);
                const fitFactor = 2; // Ajuste para que se vea bien
                camera.position.set(maxDim * fitFactor / 2, maxDim * fitFactor / 2, maxDim * fitFactor);
                
                controls.target.set(0, size.y / 2, 0); // Apuntar al centro vertical del modelo
                controls.update();
                
                scene.add(model);
                
                console.log('Modelo 3D cargado exitosamente.');
                updateOverlay('success', '¡Carga Exitosa! Usa el ratón para rotar la planta.');

            }, 
            // Función de progreso (opcional)
            function (xhr) {
                const percent = (xhr.loaded / xhr.total) * 100;
                updateOverlay('loading', `Cargando Modelo 3D: ${Math.round(percent)}%`);
            },
            // Función de error
            function (error) {
                console.error('ERROR CRÍTICO al cargar el modelo 3D:', error);
                let errorMessage = 'ERROR AL CARGAR MODELO 3D.';
                
                if (error && error.message && error.message.includes('Unexpected token')) {
                    errorMessage += ' (Archivo GLB corrupto o formato no válido)';
                } else {
                    errorMessage += ' (Ruta interna o exportación inválida)';
                }

                updateOverlay('error', errorMessage + '. Por favor, verifica tu exportación de Blender.');
            });
        }

        /**
         * Bucle de animación para Three.js.
         */
        function animate() {
            requestAnimationFrame(animate);

            const delta = clock.getDelta();
            if (mixer) {
                mixer.update(delta);
            }
            // Esto asegura que puedes girar el modelo con el ratón
            if (controls) controls.update(); 
            if (renderer) renderer.render(scene, camera);
        }

        /**
         * Maneja el cambio de tamaño de la ventana para mantener la responsividad.
         */
        function onWindowResize() {
            const canvas = document.getElementById('recyclingCanvas');
            if (!canvas || !camera || !renderer) return;

            const container = canvas.parentElement.parentElement; 
            const width = container.clientWidth;
            const height = 400; 

            // Asegúrate de que el canvas tenga el tamaño correcto antes de actualizar la cámara
            renderer.setSize(width, 400); 

            camera.aspect = width / 400;
            camera.updateProjectionMatrix();
        }

        // Carga el contenido inicial y la inicialización de Three.js al cargar la página.
        window.onload = () => {
            // PASO 1: Llama a la inicialización de la escena 3D
            initThreeJS();
            // PASO 2: Inicia el bucle de animación para el 3D
            animate();
            
            // PASO 3: Lógica de pestañas existente: Simula el clic en el primer botón.
            const initialButton = document.querySelector('[data-key="funciona"]');
            if (initialButton) {
                initialButton.click(); 
            }
            // Ajuste de tamaño inicial
            onWindowResize();
        };
    </script>

</body>
</html>